pipeline {
  agent any
  tools {
    jdk 'jdk17'
    maven 'mvn'
  }
  environments {
    SCANNER_HOME = tool 'sonar-scanner'
  }
  stages {
    stage ('clear ws') {
      steps {
        cleanWs()
      }
    }
    stage ('checkout from git') {
      steps {
        sh " git clone https://github.com/dipanjanr640/Jenkins-Zero-To-Hero.git "
      }      
    }
    stage ('sonarqube analysis') {
      steps {
        withSonarQubeEnv('sonar-server') {
         sh '''$SCANNER_HOME/bin/sonar-scanner mvn clean verify sonar:sonar -Dsonar.projectName=sprintboot-app \
         -Dsonar.projectKey=sprintboot-app'''
        }
      }      
    }
  } 
}
